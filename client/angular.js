angular
    .module('myApp', [])
    .controller('myCtrl', myCtrl)


function myCtrl($http, $location, $anchorScroll){


    var vm = this;

    vm.postBase64 = function(){

        //base64 is the long string
        var base64 = canvas.toDataURL()

        //if canvas is not empty
        if (base64 !== 'data:image/png;base64,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'){
            //post it
            $http.post('/api/base64',{base64: base64})
        }//if
    }//vm.postBase64
  

    // clear button
    vm.clrCanvas = function(){
        ctx.clearRect(0, 0, 420, 420);
    }

    //when user clicks the canvas
    vm.scrollUp = function(){
        $location.hash('top')
        $anchorScroll();
    }
    
}


function line2Grid(arr){
    var string = '';
    for (var i = 0; i < arr.length; i++){
        if (i > 0 && i % 28 === 0){
            string = string + arr[i] + '\n';
        } else {
            string = string + arr[i];
        }
    }

    return string;
}